# Testing_Core_Hypothesis

Files to reproduce the figures from the manuscript Title: The Hypothesis of a 'core' community receives poor support when confronted with simulated and emperical data

# Figure 1
Mean error in the count of core taxa relative to the true number (25) for 250 replicate simulations at each of 25 combinations of simulated conditions (6,250 total simulations with 975 non-core taxa, 25 known core taxa), and varying combinations of intensity (θ = 1 corresponding to high variance in taxon frequency, and 2, 10, 25, 50 corresponding to decreasing variance in taxon frequency), and ratio of the abundance of core to non-core taxa (1, which is a simulation with no difference in the expected taxon frequencies, and 2, 5, 10, 25 that corresponding to greater differences in the frequency of core and non-core taxa). Cells are colored according to the mean error of the 250 replicate simulations, with error calculated as the difference between the number of taxa included in the core subtracted from the known 25 core taxa. In nearly every situation, the methods do a poor job of capturing the known 25 core taxa. The hard-cutoff and proportion of reads and replicates methods are capable of accurately capturing the truth in certain situations, but not in others.

# Figure 2
True positive (top row), false positive (middle row), and net positive (bottom row) rates of assignment of taxa to the core by four different core assignment methods.  Each square represents 250 replicate simulations at each of 25 combinations simulated conditions (6,250 total simulations with 975 non-core taxa, 25 known core taxa), and varying combinations of intensity (θ = 1 corresponding to low precision in taxon abundance, and 2, 10, 25, 50 corresponding to incrasing precision in taxon frequency), and ratio of the abundance of core to non-core taxa (1, which is a simulation with no difference in the expected taxon frequencies, and 2, 5, 10, 25 that corresponding to greater differences in the frequency of core and non-core taxa). The top row (true positives) represents taxa that were simulated with core characteristics and were recovered as such, which is interpreted as signal. A true positive rate of 1 means all 25 known core taxa were assigned as such. The middle row (false positives) represents taxa which were assigned as core by the method but were simulated with non-core characteristics, which can be interpreted as noise. A false positive rate of zero represents simulations when no non-core taxa were assigned to the core, while a rate of 1 indicates all non-core taxa were incorrectly assigned to the core. The final row (true positves – false positives rate) presents the abilty of each of the four methods to discern singal from noise. A true positives – false positives rate of 1 indicates the method correctly assigned the 25 known core taxa while not ill-assigning any non-core taxa. In these circumstances core assignment methods do a good job of accurately identifying and assigning core taxa. On the other hand, a true positives – false positives rate of 0 or below indicates the method did a poor job of discerning signal from noise and assigned more non-core members to the core than true core members.   

# Figure 3
Bivariate plots showing the the application of four core methods to two published data sets (HMP, top row, (Consortium, 2012); Arabidopsis, bottom row, (Lundberg et al., 2012)) indicates that putative core taxa do not possess categorical different abundance (log transformed) or variance among replications. This is best deominstrated by the proportion of reads and replicates assignment of the HMP dataset, as non-core taxa possess similar characterstics as members of the core (furthest right top row). The outlined bins denote whether taxa in the bin are included within the core for the corresponding method. Symbols in bivariate plots have a bin size of 30 with fill color corresponding to taxa counts. The hard cut-off method, proportion of reads methods, and proportion of replicates method categorize taxa on the basis of an abundance threshold (horizontal axis) without accounting for variance vertical axis), whereas the proportion of reads and replicates incorporates both abundance and variance criteria.


